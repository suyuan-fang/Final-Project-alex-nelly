<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alex &amp; Nelly">
<meta name="dcterms.date" content="2024-12-07">

<title>Chicago Crime Prevention</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="chicago crime prevention_files/libs/clipboard/clipboard.min.js"></script>
<script src="chicago crime prevention_files/libs/quarto-html/quarto.js"></script>
<script src="chicago crime prevention_files/libs/quarto-html/popper.min.js"></script>
<script src="chicago crime prevention_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="chicago crime prevention_files/libs/quarto-html/anchor.min.js"></script>
<link href="chicago crime prevention_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="chicago crime prevention_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="chicago crime prevention_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="chicago crime prevention_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="chicago crime prevention_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link active" data-scroll-target="#executive-summary">Executive Summary</a></li>
  <li><a href="#intro" id="toc-intro" class="nav-link" data-scroll-target="#intro">Intro</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning</a></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization">Data Visualization</a></li>
  <li><a href="#heatmap-for-monthly-crime-counts-by-year" id="toc-heatmap-for-monthly-crime-counts-by-year" class="nav-link" data-scroll-target="#heatmap-for-monthly-crime-counts-by-year">Heatmap for Monthly Crime Counts by Year</a></li>
  <li><a href="#geospatial-map" id="toc-geospatial-map" class="nav-link" data-scroll-target="#geospatial-map">Geospatial Map</a></li>
  <li><a href="#shiny-app" id="toc-shiny-app" class="nav-link" data-scroll-target="#shiny-app">Shiny App</a></li>
  <li><a href="#recommendations-and-conclusion" id="toc-recommendations-and-conclusion" class="nav-link" data-scroll-target="#recommendations-and-conclusion">recommendations and conclusion</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="chicago-crime-prevention.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Chicago Crime Prevention</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Alex &amp; Nelly </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 7, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Partner 1 (name and cnet ID): Suyuan Fang - suyuanfang Partner 2 (name and cnet ID): Jiaxuan nie - Jnie21</p>
<section id="executive-summary" class="level1">
<h1>Executive Summary</h1>
<p>This report analyzes Chicago’s crime trends, with an emphasis on the correlation between crime categories, geographic locations, and seasonal fluctuations. The analysis identifies critical factors that influence crime patterns by utilizing data from the City of Chicago’s public records. Actionable strategies for reducing crime rates have been informed by a combination of spatial and temporal analysis techniques. The following are suggested: the implementation of targeted seasonal crime prevention programs, the expansion of welfare initiatives, the enhancement of urban planning, and the expansion of employment opportunities.</p>
</section>
<section id="intro" class="level1">
<h1>Intro</h1>
<p>Chicago Crime rate have been a persistent issue ove the past decade, and just recently, there have been dramatic movement in the police department that puts people in concern of the stabiltiy in safety. #Mayor Brandon Johnson, who was sworn in earlier this year, was one of the many to advocate for defunding the police in 2020 after Floyd was murdered by a Minneapolis police officer, saying “I don’t look at it as a slogan” and adding, “It’s an actual political goal,” during a podcastThe city reduced the police department by 614 positions and cut funding by 2.7% in 2021 in the immediate aftermath of Floyd’s murder. Since then, the department has grown in size and spending.</p>
<p>While the city maintained staffing levels for 2024 at the same level as the previous year, the city reported a 30% increase in crime in 2022. Murders were down 13% from 804 in 2021 to 699 in 2022, but the city stated property crime drove the spike in crime and was up 44% and violent crime was up 1% in 2022 as compared to 2021.</p>
<p>tools and information they would present could help broach discussion of the causes and solutions to the city’s deadly crime problem, and perhaps even help to answer that oft-asked question that she—and likely many other Chicagoans—field when they travel: “‘Is it really as bad as all the news says it is?’” # Research question What are the key factors influencing crime patterns in terms of type, location, and seasonality over time, and how can this information inform targeted crime prevention strategies?</p>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<div id="f69b9bde" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd  </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>file_2008_2011 <span class="op">=</span> <span class="st">"/Users/suyuanfang/Desktop/Pyhton/final project/Chicago_Crimes_2008_to_2011.csv"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>file_2012_2017 <span class="op">=</span> <span class="st">"/Users/suyuanfang/Desktop/Pyhton/final project/Chicago_Crimes_2012_to_2017.csv"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>data_2008_2011 <span class="op">=</span> pd.read_csv(file_2008_2011, on_bad_lines<span class="op">=</span><span class="st">"skip"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>data_2012_2017 <span class="op">=</span> pd.read_csv(file_2012_2017, on_bad_lines<span class="op">=</span><span class="st">"skip"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> pd.concat([data_2008_2011, data_2012_2017], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>dataset.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 4145424 entries, 0 to 4145423
Data columns (total 23 columns):
 #   Column                Dtype  
---  ------                -----  
 0   Unnamed: 0            int64  
 1   ID                    int64  
 2   Case Number           object 
 3   Date                  object 
 4   Block                 object 
 5   IUCR                  object 
 6   Primary Type          object 
 7   Description           object 
 8   Location Description  object 
 9   Arrest                bool   
 10  Domestic              bool   
 11  Beat                  int64  
 12  District              float64
 13  Ward                  float64
 14  Community Area        float64
 15  FBI Code              object 
 16  X Coordinate          float64
 17  Y Coordinate          float64
 18  Year                  int64  
 19  Updated On            object 
 20  Latitude              float64
 21  Longitude             float64
 22  Location              object 
dtypes: bool(2), float64(7), int64(4), object(10)
memory usage: 672.1+ MB</code></pre>
</div>
</div>
<p>The analysis employs data from the City of Chicago’s open data portal. The research was centered on the identification of spatial concentrations of crimes and their correlations with neighborhood demographics following the extraction, cleansing, and processing of data. Geographic visualization techniques were employed to map crime density and locations, while temporal analyses were conducted to investigate year-over-year changes and seasonality. Ultimately, an interactive Shiny App was launched to facilitate the dynamic exploration of crime trends, thereby assisting policymakers and stakeholders in visualizing the findings and customizing their interventions.</p>
</section>
<section id="data-cleaning" class="level1">
<h1>Data Cleaning</h1>
<div id="6cd952cb" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>missing_values <span class="op">=</span> dataset.isnull().<span class="bu">sum</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>missing_percent <span class="op">=</span> (missing_values <span class="op">/</span> <span class="bu">len</span>(dataset)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>missing_info <span class="op">=</span> pd.DataFrame({<span class="st">'Missing Values'</span>: missing_values, <span class="st">'Percentage'</span>: missing_percent})</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_info.sort_values(by<span class="op">=</span><span class="st">'Percentage'</span>, ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="op">=</span> dataset[dataset[<span class="st">'Year'</span>] <span class="op">!=</span> <span class="dv">2017</span>]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>columns_to_remove <span class="op">=</span> [</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Unnamed: 0"</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ID"</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"IUCR"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Beat"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Case Number"</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"District"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ward"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Updated On"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Community Area"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"X Coordinate"</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Y Coordinate"</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FBI Code"</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="op">=</span> filtered_data.drop(columns<span class="op">=</span>columns_to_remove, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>analysis_data[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(analysis_data[<span class="st">'Date'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y %I:%M:%S %p"</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>analysis_data.set_index(<span class="st">"Date"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(analysis_data.info())</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>analysis_data.head()</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>analysis_data.to_csv(<span class="st">"/Users/suyuanfang/Desktop/Pyhton/final project/analysis_data.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      Missing Values  Percentage
Location                       65728    1.585556
Longitude                      65728    1.585556
Latitude                       65728    1.585556
Y Coordinate                   65728    1.585556
X Coordinate                   65728    1.585556
Location Description            1949    0.047016
Community Area                  1495    0.036064
District                          84    0.002026
Ward                              77    0.001857
Case Number                        7    0.000169
Updated On                         0    0.000000
Year                               0    0.000000
FBI Code                           0    0.000000
Unnamed: 0                         0    0.000000
ID                                 0    0.000000
Domestic                           0    0.000000
Arrest                             0    0.000000
Description                        0    0.000000
Primary Type                       0    0.000000
IUCR                               0    0.000000
Block                              0    0.000000
Date                               0    0.000000
Beat                               0    0.000000
&lt;class 'pandas.core.frame.DataFrame'&gt;
DatetimeIndex: 4134067 entries, 2008-10-07 12:39:00 to 2016-05-03 23:38:00
Data columns (total 10 columns):
 #   Column                Dtype  
---  ------                -----  
 0   Block                 object 
 1   Primary Type          object 
 2   Description           object 
 3   Location Description  object 
 4   Arrest                bool   
 5   Domestic              bool   
 6   Year                  int64  
 7   Latitude              float64
 8   Longitude             float64
 9   Location              object 
dtypes: bool(2), float64(2), int64(1), object(5)
memory usage: 291.7+ MB
None</code></pre>
</div>
</div>
</section>
<section id="data-visualization" class="level1">
<h1>Data Visualization</h1>
<div id="b352d2d0" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>alt.data_transformers.enable(<span class="st">"default"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>primary_type_counts <span class="op">=</span> analysis_data[<span class="st">'Primary Type'</span>].value_counts().reset_index()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>primary_type_counts.columns <span class="op">=</span> [<span class="st">'Crime Type'</span>, <span class="st">'Count'</span>]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> (</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    alt.Chart(primary_type_counts.head(<span class="dv">15</span>))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    .mark_bar()</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    .encode(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>alt.X(<span class="st">'Crime Type:N'</span>, sort<span class="op">=</span><span class="st">'-y'</span>, title<span class="op">=</span><span class="st">'Crime Type'</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>alt.Y(<span class="st">'Count:Q'</span>, title<span class="op">=</span><span class="st">'Number of Crimes'</span>),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'Count:Q'</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">=</span>[<span class="st">'Crime Type'</span>, <span class="st">'Count'</span>]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    .properties(</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">'Top 15 Crime Types (Vertical)'</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">400</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>chart.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<style>
  #altair-viz-45e24b397411471aa2566f7ffa831357.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-45e24b397411471aa2566f7ffa831357.vega-embed details,
  #altair-viz-45e24b397411471aa2566f7ffa831357.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-45e24b397411471aa2566f7ffa831357"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-45e24b397411471aa2566f7ffa831357") {
      outputDiv = document.getElementById("altair-viz-45e24b397411471aa2566f7ffa831357");
    }

    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      let deps = ["vega-embed"];
      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-909430615022724115b0c5c9a85b3aa5"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "Count", "type": "quantitative"}, "tooltip": [{"field": "Crime Type", "type": "nominal"}, {"field": "Count", "type": "quantitative"}], "x": {"field": "Crime Type", "sort": "-y", "title": "Crime Type", "type": "nominal"}, "y": {"field": "Count", "title": "Number of Crimes", "type": "quantitative"}}, "height": 400, "title": "Top 15 Crime Types (Vertical)", "width": 800, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-909430615022724115b0c5c9a85b3aa5": [{"Crime Type": "THEFT", "Count": 885063}, {"Crime Type": "BATTERY", "Count": 735641}, {"Crime Type": "CRIMINAL DAMAGE", "Count": 470089}, {"Crime Type": "NARCOTICS", "Count": 435906}, {"Crime Type": "BURGLARY", "Count": 264911}, {"Crime Type": "OTHER OFFENSE", "Count": 252954}, {"Crime Type": "ASSAULT", "Count": 248744}, {"Crime Type": "MOTOR VEHICLE THEFT", "Count": 183898}, {"Crime Type": "DECEPTIVE PRACTICE", "Count": 167325}, {"Crime Type": "ROBBERY", "Count": 162934}, {"Crime Type": "CRIMINAL TRESPASS", "Count": 109493}, {"Crime Type": "WEAPONS VIOLATION", "Count": 44140}, {"Crime Type": "PUBLIC PEACE VIOLATION", "Count": 35303}, {"Crime Type": "PROSTITUTION", "Count": 32801}, {"Crime Type": "OFFENSE INVOLVING CHILDREN", "Count": 28459}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>We utilizes Altair, a visualization library, to create an interactive bar chart that displays the top 15 crime types in Chicago. First, the Altair renderer is enabled using alt.renderers.enable(“default”) to ensure proper visualization within the Jupyter Notebook, and alt.data_transformers.disable_max_rows() removes any row limitations to handle larger datasets. The data preparation step involves calculating the frequency of each crime type using value_counts() on the Primary Type column of the dataset analysis_data, followed by resetting the index and renaming the columns to Crime Type and Count. This creates a summarized DataFrame with crime types and their respective counts. The Altair chart is constructed using alt.Chart() to initialize the data, .mark_bar() to specify a bar chart, and .encode() to configure the axes, bar colors, and tooltip interactivity. The x-axis displays crime types sorted in descending order, while the y-axis shows their corresponding counts. Additional properties, such as chart title, width, and height, are customized using .properties(). Finally, the chart is displayed with chart.show(), rendering a visually engaging and interactive bar chart titled “Top 15 Crime Types (Vertical),” where theft emerges as the most frequent crime type.</p>
<div id="76c3fcce" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>location_counts <span class="op">=</span> analysis_data[<span class="st">'Location Description'</span>].value_counts().reset_index()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>location_counts.columns <span class="op">=</span> [<span class="st">'Location Description'</span>, <span class="st">'Count'</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>location_chart <span class="op">=</span> (</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    alt.Chart(location_counts.head(<span class="dv">10</span>))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    .mark_bar()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    .encode(</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>alt.X(<span class="st">'Location Description:N'</span>, sort<span class="op">=</span><span class="st">'-y'</span>, title<span class="op">=</span><span class="st">'Location'</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>alt.Y(<span class="st">'Count:Q'</span>, title<span class="op">=</span><span class="st">'Number of Crimes'</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>alt.Color(<span class="st">'Count:Q'</span>, scale<span class="op">=</span>alt.Scale(scheme<span class="op">=</span><span class="st">'blues'</span>)),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">=</span>[<span class="st">'Location Description'</span>, <span class="st">'Count'</span>]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    .properties(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">'Top 10 Crime Locations (Vertical)'</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">400</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>location_chart.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<style>
  #altair-viz-542e62dea674400a9c02967051682c5c.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-542e62dea674400a9c02967051682c5c.vega-embed details,
  #altair-viz-542e62dea674400a9c02967051682c5c.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-542e62dea674400a9c02967051682c5c"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-542e62dea674400a9c02967051682c5c") {
      outputDiv = document.getElementById("altair-viz-542e62dea674400a9c02967051682c5c");
    }

    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      let deps = ["vega-embed"];
      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-cf50336e507b82a87380f3f3b706c16b"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "Count", "scale": {"scheme": "blues"}, "type": "quantitative"}, "tooltip": [{"field": "Location Description", "type": "nominal"}, {"field": "Count", "type": "quantitative"}], "x": {"field": "Location Description", "sort": "-y", "title": "Location", "type": "nominal"}, "y": {"field": "Count", "title": "Number of Crimes", "type": "quantitative"}}, "height": 400, "title": "Top 10 Crime Locations (Vertical)", "width": 800, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-cf50336e507b82a87380f3f3b706c16b": [{"Location Description": "STREET", "Count": 1011016}, {"Location Description": "RESIDENCE", "Count": 680471}, {"Location Description": "APARTMENT", "Count": 487740}, {"Location Description": "SIDEWALK", "Count": 466845}, {"Location Description": "OTHER", "Count": 146741}, {"Location Description": "PARKING LOT/GARAGE(NON.RESID.)", "Count": 117780}, {"Location Description": "ALLEY", "Count": 92700}, {"Location Description": "SCHOOL, PUBLIC, BUILDING", "Count": 84096}, {"Location Description": "RESIDENCE-GARAGE", "Count": 80445}, {"Location Description": "SMALL RETAIL STORE", "Count": 73255}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>Then generate a bar chart showcasing the top 10 locations where crimes occur, revealing that “STREET” is the most common location for crimes. The data preparation begins by calculating the frequency of each location using the value_counts() method on the Location Description column of the analysis_data dataset, which is then converted into a DataFrame using reset_index(). The columns are renamed to Location Description and Count for clarity. The Altair chart is constructed by passing the top 10 locations (head(10)) to alt.Chart() and specifying a bar chart using .mark_bar(). The encode() function is used to configure the x-axis for location descriptions (nominal data sorted by count in descending order), the y-axis for crime counts, and the bar colors based on count values using a blue color scheme. Tooltips are added for interactivity, allowing users to hover over bars to view detailed information about each location and its corresponding count. The chart’s appearance is further customized with a title, width, and height using .properties(). Finally, the chart is displayed with location_chart.show(), rendering a clear visualization where “STREET” is identified as the location with the highest number of crimes.</p>
</section>
<section id="heatmap-for-monthly-crime-counts-by-year" class="level1">
<h1>Heatmap for Monthly Crime Counts by Year</h1>
<div id="7aa95a8e" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>monthly_data <span class="op">=</span> pd.DataFrame(analysis_data.resample(<span class="st">"M"</span>).size(), columns<span class="op">=</span>[<span class="st">"Crime Count"</span>])</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>monthly_data[<span class="st">"Month"</span>] <span class="op">=</span> monthly_data.index.month.astype(<span class="bu">str</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>monthly_data[<span class="st">"Year"</span>] <span class="op">=</span> monthly_data.index.year.astype(<span class="bu">str</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>monthly_data[<span class="st">"Month"</span>] <span class="op">=</span> monthly_data[<span class="st">"Month"</span>].astype(<span class="bu">int</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>monthly_data[<span class="st">"Month Name"</span>] <span class="op">=</span> monthly_data[<span class="st">"Month"</span>].<span class="bu">map</span>({</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">"Jan"</span>, <span class="dv">2</span>: <span class="st">"Feb"</span>, <span class="dv">3</span>: <span class="st">"Mar"</span>, <span class="dv">4</span>: <span class="st">"Apr"</span>, <span class="dv">5</span>: <span class="st">"May"</span>, <span class="dv">6</span>: <span class="st">"Jun"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>: <span class="st">"Jul"</span>, <span class="dv">8</span>: <span class="st">"Aug"</span>, <span class="dv">9</span>: <span class="st">"Sep"</span>, <span class="dv">10</span>: <span class="st">"Oct"</span>, <span class="dv">11</span>: <span class="st">"Nov"</span>, <span class="dv">12</span>: <span class="st">"Dec"</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="op">=</span> monthly_data.groupby([<span class="st">"Year"</span>, <span class="st">"Month Name"</span>])[<span class="st">"Crime Count"</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>heatmap_chart <span class="op">=</span> (</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    alt.Chart(heatmap_data)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    .mark_rect()</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    .encode(</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>alt.X(<span class="st">"Year:O"</span>, title<span class="op">=</span><span class="st">"Year"</span>),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>alt.Y(<span class="st">"Month Name:O"</span>, sort<span class="op">=</span>[<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dec"</span>], title<span class="op">=</span><span class="st">"Month"</span>),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>alt.Color(<span class="st">"Crime Count:Q"</span>, scale<span class="op">=</span>alt.Scale(scheme<span class="op">=</span><span class="st">"blues"</span>), title<span class="op">=</span><span class="st">"Crime Count"</span>),</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">=</span>[<span class="st">"Year"</span>, <span class="st">"Month Name"</span>, <span class="st">"Crime Count"</span>]</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    .properties(</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Monthly Crime Count by Year"</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">400</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>heatmap_chart.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<style>
  #altair-viz-3b6ceccf80a64c5d83b27b01ba68f0f7.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-3b6ceccf80a64c5d83b27b01ba68f0f7.vega-embed details,
  #altair-viz-3b6ceccf80a64c5d83b27b01ba68f0f7.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-3b6ceccf80a64c5d83b27b01ba68f0f7"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-3b6ceccf80a64c5d83b27b01ba68f0f7") {
      outputDiv = document.getElementById("altair-viz-3b6ceccf80a64c5d83b27b01ba68f0f7");
    }

    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      let deps = ["vega-embed"];
      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-f962e70d1fe83268c51c5d5be67b8e6a"}, "mark": {"type": "rect"}, "encoding": {"color": {"field": "Crime Count", "scale": {"scheme": "blues"}, "title": "Crime Count", "type": "quantitative"}, "tooltip": [{"field": "Year", "type": "nominal"}, {"field": "Month Name", "type": "nominal"}, {"field": "Crime Count", "type": "quantitative"}], "x": {"field": "Year", "title": "Year", "type": "ordinal"}, "y": {"field": "Month Name", "sort": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], "title": "Month", "type": "ordinal"}}, "height": 400, "title": "Monthly Crime Count by Year", "width": 800, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-f962e70d1fe83268c51c5d5be67b8e6a": [{"Year": "2008", "Month Name": "Apr", "Crime Count": 71002}, {"Year": "2008", "Month Name": "Aug", "Crime Count": 81009}, {"Year": "2008", "Month Name": "Dec", "Crime Count": 58766}, {"Year": "2008", "Month Name": "Feb", "Crime Count": 57378}, {"Year": "2008", "Month Name": "Jan", "Crime Count": 66483}, {"Year": "2008", "Month Name": "Jul", "Crime Count": 80885}, {"Year": "2008", "Month Name": "Jun", "Crime Count": 75295}, {"Year": "2008", "Month Name": "Mar", "Crime Count": 67662}, {"Year": "2008", "Month Name": "May", "Crime Count": 76034}, {"Year": "2008", "Month Name": "Nov", "Crime Count": 67051}, {"Year": "2008", "Month Name": "Oct", "Crime Count": 75687}, {"Year": "2008", "Month Name": "Sep", "Crime Count": 74801}, {"Year": "2009", "Month Name": "Apr", "Crime Count": 65058}, {"Year": "2009", "Month Name": "Aug", "Crime Count": 71560}, {"Year": "2009", "Month Name": "Dec", "Crime Count": 56304}, {"Year": "2009", "Month Name": "Feb", "Crime Count": 56403}, {"Year": "2009", "Month Name": "Jan", "Crime Count": 60333}, {"Year": "2009", "Month Name": "Jul", "Crime Count": 71252}, {"Year": "2009", "Month Name": "Jun", "Crime Count": 68454}, {"Year": "2009", "Month Name": "Mar", "Crime Count": 67319}, {"Year": "2009", "Month Name": "May", "Crime Count": 70404}, {"Year": "2009", "Month Name": "Nov", "Crime Count": 62712}, {"Year": "2009", "Month Name": "Oct", "Crime Count": 66467}, {"Year": "2009", "Month Name": "Sep", "Crime Count": 67634}, {"Year": "2010", "Month Name": "Apr", "Crime Count": 63048}, {"Year": "2010", "Month Name": "Aug", "Crime Count": 67630}, {"Year": "2010", "Month Name": "Dec", "Crime Count": 25268}, {"Year": "2010", "Month Name": "Feb", "Crime Count": 49653}, {"Year": "2010", "Month Name": "Jan", "Crime Count": 57819}, {"Year": "2010", "Month Name": "Jul", "Crime Count": 66477}, {"Year": "2010", "Month Name": "Jun", "Crime Count": 64971}, {"Year": "2010", "Month Name": "Mar", "Crime Count": 64376}, {"Year": "2010", "Month Name": "May", "Crime Count": 66434}, {"Year": "2010", "Month Name": "Nov", "Crime Count": 48378}, {"Year": "2010", "Month Name": "Oct", "Crime Count": 63628}, {"Year": "2010", "Month Name": "Sep", "Crime Count": 63009}, {"Year": "2011", "Month Name": "Apr", "Crime Count": 29113}, {"Year": "2011", "Month Name": "Aug", "Crime Count": 32616}, {"Year": "2011", "Month Name": "Dec", "Crime Count": 27042}, {"Year": "2011", "Month Name": "Feb", "Crime Count": 22247}, {"Year": "2011", "Month Name": "Jan", "Crime Count": 27213}, {"Year": "2011", "Month Name": "Jul", "Crime Count": 33274}, {"Year": "2011", "Month Name": "Jun", "Crime Count": 32341}, {"Year": "2011", "Month Name": "Mar", "Crime Count": 28707}, {"Year": "2011", "Month Name": "May", "Crime Count": 31610}, {"Year": "2011", "Month Name": "Nov", "Crime Count": 27653}, {"Year": "2011", "Month Name": "Oct", "Crime Count": 30305}, {"Year": "2011", "Month Name": "Sep", "Crime Count": 29945}, {"Year": "2012", "Month Name": "Apr", "Crime Count": 27164}, {"Year": "2012", "Month Name": "Aug", "Crime Count": 30010}, {"Year": "2012", "Month Name": "Dec", "Crime Count": 25180}, {"Year": "2012", "Month Name": "Feb", "Crime Count": 23847}, {"Year": "2012", "Month Name": "Jan", "Crime Count": 26194}, {"Year": "2012", "Month Name": "Jul", "Crime Count": 31945}, {"Year": "2012", "Month Name": "Jun", "Crime Count": 31052}, {"Year": "2012", "Month Name": "Mar", "Crime Count": 28533}, {"Year": "2012", "Month Name": "May", "Crime Count": 30067}, {"Year": "2012", "Month Name": "Nov", "Crime Count": 26010}, {"Year": "2012", "Month Name": "Oct", "Crime Count": 27938}, {"Year": "2012", "Month Name": "Sep", "Crime Count": 27730}, {"Year": "2013", "Month Name": "Apr", "Crime Count": 25492}, {"Year": "2013", "Month Name": "Aug", "Crime Count": 28622}, {"Year": "2013", "Month Name": "Dec", "Crime Count": 21819}, {"Year": "2013", "Month Name": "Feb", "Crime Count": 21372}, {"Year": "2013", "Month Name": "Jan", "Crime Count": 25357}, {"Year": "2013", "Month Name": "Jul", "Crime Count": 28593}, {"Year": "2013", "Month Name": "Jun", "Crime Count": 27325}, {"Year": "2013", "Month Name": "Mar", "Crime Count": 24922}, {"Year": "2013", "Month Name": "May", "Crime Count": 27959}, {"Year": "2013", "Month Name": "Nov", "Crime Count": 23518}, {"Year": "2013", "Month Name": "Oct", "Crime Count": 25429}, {"Year": "2013", "Month Name": "Sep", "Crime Count": 26295}, {"Year": "2014", "Month Name": "Apr", "Crime Count": 22836}, {"Year": "2014", "Month Name": "Aug", "Crime Count": 25802}, {"Year": "2014", "Month Name": "Dec", "Crime Count": 20891}, {"Year": "2014", "Month Name": "Feb", "Crime Count": 17977}, {"Year": "2014", "Month Name": "Jan", "Crime Count": 19870}, {"Year": "2014", "Month Name": "Jul", "Crime Count": 26477}, {"Year": "2014", "Month Name": "Jun", "Crime Count": 25348}, {"Year": "2014", "Month Name": "Mar", "Crime Count": 22117}, {"Year": "2014", "Month Name": "May", "Crime Count": 24807}, {"Year": "2014", "Month Name": "Nov", "Crime Count": 20680}, {"Year": "2014", "Month Name": "Oct", "Crime Count": 23911}, {"Year": "2014", "Month Name": "Sep", "Crime Count": 23811}, {"Year": "2015", "Month Name": "Apr", "Crime Count": 21610}, {"Year": "2015", "Month Name": "Aug", "Crime Count": 24685}, {"Year": "2015", "Month Name": "Dec", "Crime Count": 21006}, {"Year": "2015", "Month Name": "Feb", "Crime Count": 16287}, {"Year": "2015", "Month Name": "Jan", "Crime Count": 20656}, {"Year": "2015", "Month Name": "Jul", "Crime Count": 24101}, {"Year": "2015", "Month Name": "Jun", "Crime Count": 23059}, {"Year": "2015", "Month Name": "Mar", "Crime Count": 21560}, {"Year": "2015", "Month Name": "May", "Crime Count": 23570}, {"Year": "2015", "Month Name": "Nov", "Crime Count": 20486}, {"Year": "2015", "Month Name": "Oct", "Crime Count": 22979}, {"Year": "2015", "Month Name": "Sep", "Crime Count": 22996}, {"Year": "2016", "Month Name": "Apr", "Crime Count": 20962}, {"Year": "2016", "Month Name": "Aug", "Crime Count": 24619}, {"Year": "2016", "Month Name": "Dec", "Crime Count": 19580}, {"Year": "2016", "Month Name": "Feb", "Crime Count": 18590}, {"Year": "2016", "Month Name": "Jan", "Crime Count": 20375}, {"Year": "2016", "Month Name": "Jul", "Crime Count": 24646}, {"Year": "2016", "Month Name": "Jun", "Crime Count": 23791}, {"Year": "2016", "Month Name": "Mar", "Crime Count": 21878}, {"Year": "2016", "Month Name": "May", "Crime Count": 23332}, {"Year": "2016", "Month Name": "Nov", "Crime Count": 21140}, {"Year": "2016", "Month Name": "Oct", "Crime Count": 23314}, {"Year": "2016", "Month Name": "Sep", "Crime Count": 23235}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>For the heatmap, I first organized the data by resampling it to get monthly crime counts. I extracted the year and month from the data and converted numeric months into descriptive names like “Jan” for January. Using this processed data, I generated a heatmap where the x-axis represents the year, the y-axis represents the months (ordered from January to December), and the color intensity indicates the number of crimes in each month. Darker shades represent higher crime counts, and tooltips allow users to hover over each cell to view details. This visualization highlights trends, such as higher crime rates from 2008 to 2010 and the lowest average monthly crime rate in 2015.</p>
</section>
<section id="geospatial-map" class="level1">
<h1>Geospatial Map</h1>
<div id="5230efbd" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>alt.data_transformers.disable_max_rows()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>chicago_boundary <span class="op">=</span> gpd.read_file(<span class="st">"/Users/suyuanfang/Desktop/Pyhton/final project/transportation_20241201.geojson"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>chicago_boundary <span class="op">=</span> alt.Data(values<span class="op">=</span>chicago_boundary.__geo_interface__[<span class="st">"features"</span>])</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>map_marks <span class="op">=</span> analysis_data[[<span class="st">'Latitude'</span>, <span class="st">'Longitude'</span>, <span class="st">'Year'</span>]].dropna()</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>map_marks <span class="op">=</span> map_marks[</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    (map_marks[<span class="st">'Latitude'</span>] <span class="op">&gt;=</span> <span class="op">-</span><span class="dv">90</span>) <span class="op">&amp;</span> (map_marks[<span class="st">'Latitude'</span>] <span class="op">&lt;=</span> <span class="dv">90</span>) <span class="op">&amp;</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    (map_marks[<span class="st">'Longitude'</span>] <span class="op">&gt;=</span> <span class="op">-</span><span class="dv">180</span>) <span class="op">&amp;</span> (map_marks[<span class="st">'Longitude'</span>] <span class="op">&lt;=</span> <span class="dv">180</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>map_marks_sampled <span class="op">=</span> map_marks.groupby(<span class="st">'Year'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.sample(<span class="bu">min</span>(<span class="bu">len</span>(x), <span class="dv">2000</span>), random_state<span class="op">=</span><span class="dv">42</span>)).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>selector <span class="op">=</span> alt.selection_single(</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    fields<span class="op">=</span>[<span class="st">'Year'</span>],</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    bind<span class="op">=</span>alt.binding_select(options<span class="op">=</span><span class="bu">sorted</span>(map_marks_sampled[<span class="st">'Year'</span>].unique())),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Select Year"</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>background_map <span class="op">=</span> alt.Chart(chicago_boundary).mark_geoshape(</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">=</span><span class="st">"lightgray"</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    stroke<span class="op">=</span><span class="st">"black"</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>).properties(</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">700</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>).project(</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">type</span><span class="op">=</span><span class="st">'mercator'</span>  </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>crime_map <span class="op">=</span> alt.Chart(map_marks_sampled).mark_circle(size<span class="op">=</span><span class="dv">20</span>, opacity<span class="op">=</span><span class="fl">0.5</span>).encode(</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    longitude<span class="op">=</span>alt.Longitude(<span class="st">'Longitude:Q'</span>, title<span class="op">=</span><span class="st">'Longitude'</span>),</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    latitude<span class="op">=</span>alt.Latitude(<span class="st">'Latitude:Q'</span>, title<span class="op">=</span><span class="st">'Latitude'</span>),</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>alt.value(<span class="st">"blue"</span>),</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">=</span>[<span class="st">'Latitude:Q'</span>, <span class="st">'Longitude:Q'</span>, <span class="st">'Year:O'</span>]</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>).add_selection(</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    selector</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>).transform_filter(</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    selector</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>final_map <span class="op">=</span> background_map <span class="op">+</span> crime_map</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>final_map.properties(</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Crime Locations in Chicago by Year"</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>).show()</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>selected_year <span class="op">=</span> <span class="dv">2008</span>  </span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>year_data <span class="op">=</span> map_marks_sampled[map_marks_sampled[<span class="st">'Year'</span>] <span class="op">==</span> selected_year]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For the geospatial map, I used a GeoJSON file to overlay crime locations on a map of Chicago, showing the city’s boundaries for context. I cleaned the data by removing invalid latitude and longitude values to ensure accuracy. To handle the large dataset, I applied stratified random sampling, limiting the number of data points to 2,000 per year. This keeps the map clear and easy to interpret while still representing the data well. An interactive year selector allows users to filter crime locations for specific years, making it simple to focus on a particular time frame. The map uses a light gray base layer with black borders to display Chicago’s boundaries, and individual crime locations are plotted as semi-transparent blue circles. Tooltips provide details like latitude, longitude, and year when hovered over, adding interactivity. This map lets users explore how crime patterns change over time and across different areas of the city. It highlights trends, such as shifts in hotspots or consistent problem areas, offering useful insights for better understanding and decision-making.</p>
<div id="55cc1fa2" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>chicago_boundary <span class="op">=</span> gpd.read_file(<span class="st">"/Users/suyuanfang/Desktop/Pyhton/final project/transportation_20241201.geojson"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>chicago_boundary_alt <span class="op">=</span> alt.Data(values<span class="op">=</span>chicago_boundary.__geo_interface__[<span class="st">"features"</span>])</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>theft_data <span class="op">=</span> analysis_data[[<span class="st">'Latitude'</span>, <span class="st">'Longitude'</span>, <span class="st">'Year'</span>, <span class="st">'Primary Type'</span>]].dropna()</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>theft_data <span class="op">=</span> theft_data[</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    (theft_data[<span class="st">'Latitude'</span>] <span class="op">&gt;=</span> <span class="op">-</span><span class="dv">90</span>) <span class="op">&amp;</span> (theft_data[<span class="st">'Latitude'</span>] <span class="op">&lt;=</span> <span class="dv">90</span>) <span class="op">&amp;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    (theft_data[<span class="st">'Longitude'</span>] <span class="op">&gt;=</span> <span class="op">-</span><span class="dv">180</span>) <span class="op">&amp;</span> (theft_data[<span class="st">'Longitude'</span>] <span class="op">&lt;=</span> <span class="dv">180</span>) <span class="op">&amp;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    (theft_data[<span class="st">'Primary Type'</span>] <span class="op">==</span> <span class="st">'THEFT'</span>)  </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>theft_sampled <span class="op">=</span> theft_data.groupby(<span class="st">'Year'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.sample(<span class="bu">min</span>(<span class="bu">len</span>(x), <span class="dv">2000</span>), random_state<span class="op">=</span><span class="dv">42</span>)).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>selector <span class="op">=</span> alt.selection_single(</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    fields<span class="op">=</span>[<span class="st">'Year'</span>],</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    bind<span class="op">=</span>alt.binding_select(options<span class="op">=</span><span class="bu">sorted</span>(theft_sampled[<span class="st">'Year'</span>].unique())),</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Select Year"</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>background_map <span class="op">=</span> alt.Chart(chicago_boundary_alt).mark_geoshape(</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">=</span><span class="st">"lightgray"</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    stroke<span class="op">=</span><span class="st">"black"</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>).properties(</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">700</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>).project(</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">type</span><span class="op">=</span><span class="st">'mercator'</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>theft_map <span class="op">=</span> alt.Chart(theft_sampled).mark_circle(size<span class="op">=</span><span class="dv">20</span>, opacity<span class="op">=</span><span class="fl">0.5</span>).encode(</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    longitude<span class="op">=</span>alt.Longitude(<span class="st">'Longitude:Q'</span>, title<span class="op">=</span><span class="st">'Longitude'</span>),</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    latitude<span class="op">=</span>alt.Latitude(<span class="st">'Latitude:Q'</span>, title<span class="op">=</span><span class="st">'Latitude'</span>),</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>alt.value(<span class="st">"orange"</span>),  </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">=</span>[<span class="st">'Latitude:Q'</span>, <span class="st">'Longitude:Q'</span>, <span class="st">'Year:O'</span>]</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>).add_selection(</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    selector</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>).transform_filter(</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    selector</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>final_map <span class="op">=</span> background_map <span class="op">+</span> theft_map</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>final_map.properties(</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Theft Crime Locations in Chicago by Year"</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>).show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We created a script that reads a GeoJSON file containing Chicago’s boundary data and converts it into a format compatible with Altair. By filtering the dataset for valid latitude and longitude values and focusing specifically on the “THEFT” crime type, we ensured that the analysis exclusively concentrates on larceny offenses, keeping the data relevant. To improve visualization clarity and performance, we applied stratified random sampling, limiting the dataset to a maximum of 2,000 points per year.</p>
<p>We used alt.selection_single() to implement a dynamic year selector, allowing users to interactively choose specific years from a dropdown menu. To ensure geographic accuracy, we employed the Mercator projection to render the background map of Chicago, with black borders and a light gray fill. Theft crime locations are overlaid as semi-transparent orange circles, and tooltips display details such as latitude, longitude, and year when hovered over. Our interactive visualization, “Theft Crime Locations in Chicago by Year (With Map Background),” combines the boundary map and crime data to help users explore spatial and temporal patterns of theft. This tool offers valuable insights into theft hotspots and trends over time, supporting data-driven decision-making and resource allocation.</p>
</section>
<section id="shiny-app" class="level1">
<h1>Shiny App</h1>
<p>import pandas as pd from shiny import App, render, ui, reactive import altair as alt import nest_asyncio</p>
<p>nest_asyncio.apply()</p>
<p>analysis_data = pd.read_csv(‘/Users/suyuanfang/Desktop/Pyhton/final project/analysis_data.csv’)</p>
<p>crime_types = analysis_data[‘Primary Type’].unique()</p>
<p>app_ui = ui.page_fluid( ui.h1(“Chicago Crime Data Visualization”), ui.input_selectize( “crime_types”, “Select Crime Types:”, choices=sorted(crime_types.tolist()), selected=crime_types.tolist()[:5], multiple=True, ), ui.output_ui(“crime_plot”) )</p>
<p>def server(input, output, session): <span class="citation" data-cites="reactive.Calc">@reactive.Calc</span> def filtered_data(): selected_types = input.crime_types() if not selected_types: return pd.DataFrame(columns=[‘Primary Type’]) return analysis_data[analysis_data[‘Primary Type’].isin(selected_types)]</p>
<pre><code>@output
@render.ui
def crime_plot():
    data = filtered_data()
    if data.empty:
        empty_chart = alt.Chart(pd.DataFrame({'x': [], 'y': []})).mark_bar()
        return ui.HTML(empty_chart.to_html())

    crime_counts = data['Primary Type'].value_counts().reset_index()
    crime_counts.columns = ['Crime_Type', 'Count']

    chart = (
        alt.Chart(crime_counts)
        .mark_bar()
        .encode(
            x=alt.X('Crime_Type:N', sort='-y', title='Crime Type'),
            y=alt.Y('Count:Q', title='Number of Crimes'),
            color=alt.Color('Count:Q', scale=alt.Scale(scheme='blues')),
            tooltip=['Crime_Type', 'Count'],
        )
        .properties(
            title='Number of Crimes for Selected Crime Types',
            width='container',
            height=400,
        )
        .configure_axis(labelAngle=-45)
    )
    return ui.HTML(chart.to_html())</code></pre>
<p>app = App(app_ui, server)</p>
<p>if <strong>name</strong> == “<strong>main</strong>”: app.run()</p>
<p>This Shiny app allows users to explore Chicago crime data interactively. It loads crime data from a CSV file and provides a dropdown menu where users can select one or more crime types to analyze. Based on the selected types, the app filters the data and dynamically generates a bar chart using Altair. The chart displays the number of crimes for each selected type, with color intensity representing the counts and tooltips showing details when hovering over the bars. The app ensures a smooth user experience by dynamically updating the chart in response to user input and handling cases where no data is selected.</p>
</section>
<section id="recommendations-and-conclusion" class="level1">
<h1>recommendations and conclusion</h1>
<p>In order to address these obstacles, it is imperative to implement a multifaceted strategy that combines immediate interventions with long-term structural reforms. It is advised that seasonal crime prevention programs be implemented to address specific crime categories during their peak periods. For example, the implementation of targeted measures during the winter can address property crimes, while the deployment of additional law enforcement resources and community outreach programs during the summer can help mitigate the increase in larceny.</p>
<p>In order to address the root causes of illicit activity, it is essential to expand welfare programs. Investing in education, mental health services, and affordable housing can significantly reduce crime rates by addressing the underlying social inequalities. These initiatives should prioritize communities that have been identified as high-crime areas through the analysis.</p>
<p>Urban planning has a substantial impact on crime prevention. By enhancing the visibility and illumination of public spaces, particularly in high-crime areas, it is possible to deter criminal activities. The establishment of secure neighborhoods is facilitated by the promotion of mixed-use developments that integrate residential, commercial, and recreational spaces, thereby fostering informal surveillance and community engagement.</p>
<p>Finally, the reduction of crime requires the expansion of employment opportunities. Residents can acquire the requisite skills for sustainable employment through vocational training programs, while job opportunities can be generated in vulnerable communities through partnerships with local businesses. In addition to improving economic prospects, these initiatives enhance a sense of community stability and resilience.</p>
<p>The findings of this report emphasize the importance of data-driven policymaking in Chicago’s crime prevention initiatives. By integrating seasonal prevention strategies, welfare support, urban redevelopment, and employment growth, policymakers can develop comprehensive solutions that promote safety and equity. The holistic approach of addressing crime through socioeconomic empowerment and sustainable development is consistent with the progressive vision, which will enable a more prosperous and secure Chicago.</p>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb11" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Chicago Crime Prevention"</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Alex &amp; Nelly" </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2024-12-07</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">    colorlinks: true</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: true  </span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> </span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">  kernelspec:</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">    name: python3</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">    display_name: Python 3</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">    language: python</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co">  path: /opt/miniconda3/bin/python3  </span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>Partner 1 (name and cnet ID): Suyuan Fang - suyuanfang</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>Partner 2 (name and cnet ID): Jiaxuan nie - Jnie21 </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="fu"># Executive Summary </span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>This report analyzes Chicago's crime trends, with an emphasis on the correlation between crime categories, geographic locations, and seasonal fluctuations. The analysis identifies critical factors that influence crime patterns by utilizing data from the City of Chicago's public records. Actionable strategies for reducing crime rates have been informed by a combination of spatial and temporal analysis techniques. The following are suggested: the implementation of targeted seasonal crime prevention programs, the expansion of welfare initiatives, the enhancement of urban planning, and the expansion of employment opportunities.</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="fu"># Intro </span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>Chicago Crime rate have been a persistent issue ove the past decade, and just recently, there have been dramatic movement in the police department that puts people in concern of the stabiltiy in safety. </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>#Mayor Brandon Johnson, who was sworn in earlier this year, was one of the many to advocate for defunding the police in 2020 after Floyd was murdered by a Minneapolis police officer, saying “I don’t look at it as a slogan” and adding, “It’s an actual political goal," during a podcastThe city reduced the police department by 614 positions and cut funding by 2.7% in 2021 in the immediate aftermath of Floyd's murder. Since then, the department has grown in size and spending.</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>While the city maintained staffing levels for 2024 at the same level as the previous year, the city reported a 30% increase in crime in 2022. Murders were down 13% from 804 in 2021 to 699 in 2022, but the city stated property crime drove the spike in crime and was up 44% and violent crime was up 1% in 2022 as compared to 2021.</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>tools and information they would present could help broach discussion of the causes and solutions to the city’s deadly crime problem, and perhaps even help to answer that oft-asked question that she—and likely many other Chicagoans—field when they travel: “‘Is it really as bad as all the news says it is?’” </span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="fu"># Research question</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>What are the key factors influencing crime patterns in terms of type, location, and seasonality over time, and how can this information inform targeted crime prevention strategies?</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  </span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd  </span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>file_2008_2011 <span class="op">=</span> <span class="st">"/Users/suyuanfang/Desktop/Pyhton/final project/Chicago_Crimes_2008_to_2011.csv"</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>file_2012_2017 <span class="op">=</span> <span class="st">"/Users/suyuanfang/Desktop/Pyhton/final project/Chicago_Crimes_2012_to_2017.csv"</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>data_2008_2011 <span class="op">=</span> pd.read_csv(file_2008_2011, on_bad_lines<span class="op">=</span><span class="st">"skip"</span>)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>data_2012_2017 <span class="op">=</span> pd.read_csv(file_2012_2017, on_bad_lines<span class="op">=</span><span class="st">"skip"</span>)</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> pd.concat([data_2008_2011, data_2012_2017], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>dataset.info()</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>The analysis employs data from the City of Chicago's open data portal. The research was centered on the identification of spatial concentrations of crimes and their correlations with neighborhood demographics following the extraction, cleansing, and processing of data. Geographic visualization techniques were employed to map crime density and locations, while temporal analyses were conducted to investigate year-over-year changes and seasonality. Ultimately, an interactive Shiny App was launched to facilitate the dynamic exploration of crime trends, thereby assisting policymakers and stakeholders in visualizing the findings and customizing their interventions.</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Cleaning</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>missing_values <span class="op">=</span> dataset.isnull().<span class="bu">sum</span>()</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>missing_percent <span class="op">=</span> (missing_values <span class="op">/</span> <span class="bu">len</span>(dataset)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>missing_info <span class="op">=</span> pd.DataFrame({<span class="st">'Missing Values'</span>: missing_values, <span class="st">'Percentage'</span>: missing_percent})</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_info.sort_values(by<span class="op">=</span><span class="st">'Percentage'</span>, ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="op">=</span> dataset[dataset[<span class="st">'Year'</span>] <span class="op">!=</span> <span class="dv">2017</span>]</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>columns_to_remove <span class="op">=</span> [</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Unnamed: 0"</span>,</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ID"</span>,</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">"IUCR"</span>,</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Beat"</span>,</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Case Number"</span>,</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">"District"</span>,</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ward"</span>,</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Updated On"</span>,</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Community Area"</span>,</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">"X Coordinate"</span>,</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Y Coordinate"</span>,</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FBI Code"</span>,</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="op">=</span> filtered_data.drop(columns<span class="op">=</span>columns_to_remove, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>analysis_data[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(analysis_data[<span class="st">'Date'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y %I:%M:%S %p"</span>)</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>analysis_data.set_index(<span class="st">"Date"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(analysis_data.info())</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>analysis_data.head()</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>analysis_data.to_csv(<span class="st">"/Users/suyuanfang/Desktop/Pyhton/final project/analysis_data.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Visualization</span></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>alt.data_transformers.enable(<span class="st">"default"</span>)</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>primary_type_counts <span class="op">=</span> analysis_data[<span class="st">'Primary Type'</span>].value_counts().reset_index()</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>primary_type_counts.columns <span class="op">=</span> [<span class="st">'Crime Type'</span>, <span class="st">'Count'</span>]</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> (</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>    alt.Chart(primary_type_counts.head(<span class="dv">15</span>))</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>    .mark_bar()</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>    .encode(</span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>alt.X(<span class="st">'Crime Type:N'</span>, sort<span class="op">=</span><span class="st">'-y'</span>, title<span class="op">=</span><span class="st">'Crime Type'</span>),</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>alt.Y(<span class="st">'Count:Q'</span>, title<span class="op">=</span><span class="st">'Number of Crimes'</span>),</span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'Count:Q'</span>,</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">=</span>[<span class="st">'Crime Type'</span>, <span class="st">'Count'</span>]</span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>    .properties(</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">'Top 15 Crime Types (Vertical)'</span>,</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">400</span></span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>chart.show()</span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>We utilizes Altair, a visualization library, to create an interactive bar chart that displays the top 15 crime types in Chicago. First, the Altair renderer is enabled using alt.renderers.enable("default") to ensure proper visualization within the Jupyter Notebook, and alt.data_transformers.disable_max_rows() removes any row limitations to handle larger datasets. The data preparation step involves calculating the frequency of each crime type using value_counts() on the Primary Type column of the dataset analysis_data, followed by resetting the index and renaming the columns to Crime Type and Count. This creates a summarized DataFrame with crime types and their respective counts. The Altair chart is constructed using alt.Chart() to initialize the data, .mark_bar() to specify a bar chart, and .encode() to configure the axes, bar colors, and tooltip interactivity. The x-axis displays crime types sorted in descending order, while the y-axis shows their corresponding counts. Additional properties, such as chart title, width, and height, are customized using .properties(). Finally, the chart is displayed with chart.show(), rendering a visually engaging and interactive bar chart titled “Top 15 Crime Types (Vertical),” where theft emerges as the most frequent crime type.</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>location_counts <span class="op">=</span> analysis_data[<span class="st">'Location Description'</span>].value_counts().reset_index()</span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>location_counts.columns <span class="op">=</span> [<span class="st">'Location Description'</span>, <span class="st">'Count'</span>]</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>location_chart <span class="op">=</span> (</span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>    alt.Chart(location_counts.head(<span class="dv">10</span>))</span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>    .mark_bar()</span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a>    .encode(</span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>alt.X(<span class="st">'Location Description:N'</span>, sort<span class="op">=</span><span class="st">'-y'</span>, title<span class="op">=</span><span class="st">'Location'</span>),</span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>alt.Y(<span class="st">'Count:Q'</span>, title<span class="op">=</span><span class="st">'Number of Crimes'</span>),</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>alt.Color(<span class="st">'Count:Q'</span>, scale<span class="op">=</span>alt.Scale(scheme<span class="op">=</span><span class="st">'blues'</span>)),</span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">=</span>[<span class="st">'Location Description'</span>, <span class="st">'Count'</span>]</span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>    .properties(</span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">'Top 10 Crime Locations (Vertical)'</span>,</span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">400</span></span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>location_chart.show()</span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>Then generate a bar chart showcasing the top 10 locations where crimes occur, revealing that "STREET" is the most common location for crimes. The data preparation begins by calculating the frequency of each location using the value_counts() method on the Location Description column of the analysis_data dataset, which is then converted into a DataFrame using reset_index(). The columns are renamed to Location Description and Count for clarity. The Altair chart is constructed by passing the top 10 locations (head(10)) to alt.Chart() and specifying a bar chart using .mark_bar(). The encode() function is used to configure the x-axis for location descriptions (nominal data sorted by count in descending order), the y-axis for crime counts, and the bar colors based on count values using a blue color scheme. Tooltips are added for interactivity, allowing users to hover over bars to view detailed information about each location and its corresponding count. The chart's appearance is further customized with a title, width, and height using .properties(). Finally, the chart is displayed with location_chart.show(), rendering a clear visualization where "STREET" is identified as the location with the highest number of crimes.</span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a><span class="fu"># Heatmap for Monthly Crime Counts by Year</span></span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>monthly_data <span class="op">=</span> pd.DataFrame(analysis_data.resample(<span class="st">"M"</span>).size(), columns<span class="op">=</span>[<span class="st">"Crime Count"</span>])</span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a>monthly_data[<span class="st">"Month"</span>] <span class="op">=</span> monthly_data.index.month.astype(<span class="bu">str</span>)</span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>monthly_data[<span class="st">"Year"</span>] <span class="op">=</span> monthly_data.index.year.astype(<span class="bu">str</span>)</span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>monthly_data[<span class="st">"Month"</span>] <span class="op">=</span> monthly_data[<span class="st">"Month"</span>].astype(<span class="bu">int</span>)</span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>monthly_data[<span class="st">"Month Name"</span>] <span class="op">=</span> monthly_data[<span class="st">"Month"</span>].<span class="bu">map</span>({</span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">"Jan"</span>, <span class="dv">2</span>: <span class="st">"Feb"</span>, <span class="dv">3</span>: <span class="st">"Mar"</span>, <span class="dv">4</span>: <span class="st">"Apr"</span>, <span class="dv">5</span>: <span class="st">"May"</span>, <span class="dv">6</span>: <span class="st">"Jun"</span>,</span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>: <span class="st">"Jul"</span>, <span class="dv">8</span>: <span class="st">"Aug"</span>, <span class="dv">9</span>: <span class="st">"Sep"</span>, <span class="dv">10</span>: <span class="st">"Oct"</span>, <span class="dv">11</span>: <span class="st">"Nov"</span>, <span class="dv">12</span>: <span class="st">"Dec"</span></span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="op">=</span> monthly_data.groupby([<span class="st">"Year"</span>, <span class="st">"Month Name"</span>])[<span class="st">"Crime Count"</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a>heatmap_chart <span class="op">=</span> (</span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a>    alt.Chart(heatmap_data)</span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a>    .mark_rect()</span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>    .encode(</span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>alt.X(<span class="st">"Year:O"</span>, title<span class="op">=</span><span class="st">"Year"</span>),</span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>alt.Y(<span class="st">"Month Name:O"</span>, sort<span class="op">=</span>[<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>,</span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dec"</span>], title<span class="op">=</span><span class="st">"Month"</span>),</span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>alt.Color(<span class="st">"Crime Count:Q"</span>, scale<span class="op">=</span>alt.Scale(scheme<span class="op">=</span><span class="st">"blues"</span>), title<span class="op">=</span><span class="st">"Crime Count"</span>),</span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">=</span>[<span class="st">"Year"</span>, <span class="st">"Month Name"</span>, <span class="st">"Crime Count"</span>]</span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a>    .properties(</span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Monthly Crime Count by Year"</span>,</span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">400</span></span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a>heatmap_chart.show()</span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a>For the heatmap, I first organized the data by resampling it to get monthly crime counts. I extracted the year and month from the data and converted numeric months into descriptive names like "Jan" for January. Using this processed data, I generated a heatmap where the x-axis represents the year, the y-axis represents the months (ordered from January to December), and the color intensity indicates the number of crimes in each month. Darker shades represent higher crime counts, and tooltips allow users to hover over each cell to view details. This visualization highlights trends, such as higher crime rates from 2008 to 2010 and the lowest average monthly crime rate in 2015.</span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a><span class="fu"># Geospatial Map</span></span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a>alt.data_transformers.disable_max_rows()</span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a>chicago_boundary <span class="op">=</span> gpd.read_file(<span class="st">"/Users/suyuanfang/Desktop/Pyhton/final project/transportation_20241201.geojson"</span>)</span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a>chicago_boundary <span class="op">=</span> alt.Data(values<span class="op">=</span>chicago_boundary.__geo_interface__[<span class="st">"features"</span>])</span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a>map_marks <span class="op">=</span> analysis_data[[<span class="st">'Latitude'</span>, <span class="st">'Longitude'</span>, <span class="st">'Year'</span>]].dropna()</span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a>map_marks <span class="op">=</span> map_marks[</span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a>    (map_marks[<span class="st">'Latitude'</span>] <span class="op">&gt;=</span> <span class="op">-</span><span class="dv">90</span>) <span class="op">&amp;</span> (map_marks[<span class="st">'Latitude'</span>] <span class="op">&lt;=</span> <span class="dv">90</span>) <span class="op">&amp;</span> </span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a>    (map_marks[<span class="st">'Longitude'</span>] <span class="op">&gt;=</span> <span class="op">-</span><span class="dv">180</span>) <span class="op">&amp;</span> (map_marks[<span class="st">'Longitude'</span>] <span class="op">&lt;=</span> <span class="dv">180</span>)</span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a>map_marks_sampled <span class="op">=</span> map_marks.groupby(<span class="st">'Year'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.sample(<span class="bu">min</span>(<span class="bu">len</span>(x), <span class="dv">2000</span>), random_state<span class="op">=</span><span class="dv">42</span>)).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a>selector <span class="op">=</span> alt.selection_single(</span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a>    fields<span class="op">=</span>[<span class="st">'Year'</span>],</span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a>    bind<span class="op">=</span>alt.binding_select(options<span class="op">=</span><span class="bu">sorted</span>(map_marks_sampled[<span class="st">'Year'</span>].unique())),</span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Select Year"</span></span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a>background_map <span class="op">=</span> alt.Chart(chicago_boundary).mark_geoshape(</span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">=</span><span class="st">"lightgray"</span>,</span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a>    stroke<span class="op">=</span><span class="st">"black"</span></span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a>).properties(</span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb11-227"><a href="#cb11-227" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">700</span></span>
<span id="cb11-228"><a href="#cb11-228" aria-hidden="true" tabindex="-1"></a>).project(</span>
<span id="cb11-229"><a href="#cb11-229" aria-hidden="true" tabindex="-1"></a>    <span class="bu">type</span><span class="op">=</span><span class="st">'mercator'</span>  </span>
<span id="cb11-230"><a href="#cb11-230" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-231"><a href="#cb11-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-232"><a href="#cb11-232" aria-hidden="true" tabindex="-1"></a>crime_map <span class="op">=</span> alt.Chart(map_marks_sampled).mark_circle(size<span class="op">=</span><span class="dv">20</span>, opacity<span class="op">=</span><span class="fl">0.5</span>).encode(</span>
<span id="cb11-233"><a href="#cb11-233" aria-hidden="true" tabindex="-1"></a>    longitude<span class="op">=</span>alt.Longitude(<span class="st">'Longitude:Q'</span>, title<span class="op">=</span><span class="st">'Longitude'</span>),</span>
<span id="cb11-234"><a href="#cb11-234" aria-hidden="true" tabindex="-1"></a>    latitude<span class="op">=</span>alt.Latitude(<span class="st">'Latitude:Q'</span>, title<span class="op">=</span><span class="st">'Latitude'</span>),</span>
<span id="cb11-235"><a href="#cb11-235" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>alt.value(<span class="st">"blue"</span>),</span>
<span id="cb11-236"><a href="#cb11-236" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">=</span>[<span class="st">'Latitude:Q'</span>, <span class="st">'Longitude:Q'</span>, <span class="st">'Year:O'</span>]</span>
<span id="cb11-237"><a href="#cb11-237" aria-hidden="true" tabindex="-1"></a>).add_selection(</span>
<span id="cb11-238"><a href="#cb11-238" aria-hidden="true" tabindex="-1"></a>    selector</span>
<span id="cb11-239"><a href="#cb11-239" aria-hidden="true" tabindex="-1"></a>).transform_filter(</span>
<span id="cb11-240"><a href="#cb11-240" aria-hidden="true" tabindex="-1"></a>    selector</span>
<span id="cb11-241"><a href="#cb11-241" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-242"><a href="#cb11-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-243"><a href="#cb11-243" aria-hidden="true" tabindex="-1"></a>final_map <span class="op">=</span> background_map <span class="op">+</span> crime_map</span>
<span id="cb11-244"><a href="#cb11-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-245"><a href="#cb11-245" aria-hidden="true" tabindex="-1"></a>final_map.properties(</span>
<span id="cb11-246"><a href="#cb11-246" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Crime Locations in Chicago by Year"</span></span>
<span id="cb11-247"><a href="#cb11-247" aria-hidden="true" tabindex="-1"></a>).show()</span>
<span id="cb11-248"><a href="#cb11-248" aria-hidden="true" tabindex="-1"></a>selected_year <span class="op">=</span> <span class="dv">2008</span>  </span>
<span id="cb11-249"><a href="#cb11-249" aria-hidden="true" tabindex="-1"></a>year_data <span class="op">=</span> map_marks_sampled[map_marks_sampled[<span class="st">'Year'</span>] <span class="op">==</span> selected_year]</span>
<span id="cb11-250"><a href="#cb11-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-251"><a href="#cb11-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-252"><a href="#cb11-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-253"><a href="#cb11-253" aria-hidden="true" tabindex="-1"></a>For the geospatial map, I used a GeoJSON file to overlay crime locations on a map of Chicago, showing the city’s boundaries for context. I cleaned the data by removing invalid latitude and longitude values to ensure accuracy. To handle the large dataset, I applied stratified random sampling, limiting the number of data points to 2,000 per year. This keeps the map clear and easy to interpret while still representing the data well.</span>
<span id="cb11-254"><a href="#cb11-254" aria-hidden="true" tabindex="-1"></a>An interactive year selector allows users to filter crime locations for specific years, making it simple to focus on a particular time frame. The map uses a light gray base layer with black borders to display Chicago’s boundaries, and individual crime locations are plotted as semi-transparent blue circles. Tooltips provide details like latitude, longitude, and year when hovered over, adding interactivity.</span>
<span id="cb11-255"><a href="#cb11-255" aria-hidden="true" tabindex="-1"></a>This map lets users explore how crime patterns change over time and across different areas of the city. It highlights trends, such as shifts in hotspots or consistent problem areas, offering useful insights for better understanding and decision-making.</span>
<span id="cb11-256"><a href="#cb11-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-259"><a href="#cb11-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb11-260"><a href="#cb11-260" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb11-261"><a href="#cb11-261" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-262"><a href="#cb11-262" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb11-263"><a href="#cb11-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-264"><a href="#cb11-264" aria-hidden="true" tabindex="-1"></a>chicago_boundary <span class="op">=</span> gpd.read_file(<span class="st">"/Users/suyuanfang/Desktop/Pyhton/final project/transportation_20241201.geojson"</span>)</span>
<span id="cb11-265"><a href="#cb11-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-266"><a href="#cb11-266" aria-hidden="true" tabindex="-1"></a>chicago_boundary_alt <span class="op">=</span> alt.Data(values<span class="op">=</span>chicago_boundary.__geo_interface__[<span class="st">"features"</span>])</span>
<span id="cb11-267"><a href="#cb11-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-268"><a href="#cb11-268" aria-hidden="true" tabindex="-1"></a>theft_data <span class="op">=</span> analysis_data[[<span class="st">'Latitude'</span>, <span class="st">'Longitude'</span>, <span class="st">'Year'</span>, <span class="st">'Primary Type'</span>]].dropna()</span>
<span id="cb11-269"><a href="#cb11-269" aria-hidden="true" tabindex="-1"></a>theft_data <span class="op">=</span> theft_data[</span>
<span id="cb11-270"><a href="#cb11-270" aria-hidden="true" tabindex="-1"></a>    (theft_data[<span class="st">'Latitude'</span>] <span class="op">&gt;=</span> <span class="op">-</span><span class="dv">90</span>) <span class="op">&amp;</span> (theft_data[<span class="st">'Latitude'</span>] <span class="op">&lt;=</span> <span class="dv">90</span>) <span class="op">&amp;</span></span>
<span id="cb11-271"><a href="#cb11-271" aria-hidden="true" tabindex="-1"></a>    (theft_data[<span class="st">'Longitude'</span>] <span class="op">&gt;=</span> <span class="op">-</span><span class="dv">180</span>) <span class="op">&amp;</span> (theft_data[<span class="st">'Longitude'</span>] <span class="op">&lt;=</span> <span class="dv">180</span>) <span class="op">&amp;</span></span>
<span id="cb11-272"><a href="#cb11-272" aria-hidden="true" tabindex="-1"></a>    (theft_data[<span class="st">'Primary Type'</span>] <span class="op">==</span> <span class="st">'THEFT'</span>)  </span>
<span id="cb11-273"><a href="#cb11-273" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb11-274"><a href="#cb11-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-275"><a href="#cb11-275" aria-hidden="true" tabindex="-1"></a>theft_sampled <span class="op">=</span> theft_data.groupby(<span class="st">'Year'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.sample(<span class="bu">min</span>(<span class="bu">len</span>(x), <span class="dv">2000</span>), random_state<span class="op">=</span><span class="dv">42</span>)).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-276"><a href="#cb11-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-277"><a href="#cb11-277" aria-hidden="true" tabindex="-1"></a>selector <span class="op">=</span> alt.selection_single(</span>
<span id="cb11-278"><a href="#cb11-278" aria-hidden="true" tabindex="-1"></a>    fields<span class="op">=</span>[<span class="st">'Year'</span>],</span>
<span id="cb11-279"><a href="#cb11-279" aria-hidden="true" tabindex="-1"></a>    bind<span class="op">=</span>alt.binding_select(options<span class="op">=</span><span class="bu">sorted</span>(theft_sampled[<span class="st">'Year'</span>].unique())),</span>
<span id="cb11-280"><a href="#cb11-280" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Select Year"</span></span>
<span id="cb11-281"><a href="#cb11-281" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-282"><a href="#cb11-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-283"><a href="#cb11-283" aria-hidden="true" tabindex="-1"></a>background_map <span class="op">=</span> alt.Chart(chicago_boundary_alt).mark_geoshape(</span>
<span id="cb11-284"><a href="#cb11-284" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">=</span><span class="st">"lightgray"</span>,</span>
<span id="cb11-285"><a href="#cb11-285" aria-hidden="true" tabindex="-1"></a>    stroke<span class="op">=</span><span class="st">"black"</span></span>
<span id="cb11-286"><a href="#cb11-286" aria-hidden="true" tabindex="-1"></a>).properties(</span>
<span id="cb11-287"><a href="#cb11-287" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb11-288"><a href="#cb11-288" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">700</span></span>
<span id="cb11-289"><a href="#cb11-289" aria-hidden="true" tabindex="-1"></a>).project(</span>
<span id="cb11-290"><a href="#cb11-290" aria-hidden="true" tabindex="-1"></a>    <span class="bu">type</span><span class="op">=</span><span class="st">'mercator'</span></span>
<span id="cb11-291"><a href="#cb11-291" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-292"><a href="#cb11-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-293"><a href="#cb11-293" aria-hidden="true" tabindex="-1"></a>theft_map <span class="op">=</span> alt.Chart(theft_sampled).mark_circle(size<span class="op">=</span><span class="dv">20</span>, opacity<span class="op">=</span><span class="fl">0.5</span>).encode(</span>
<span id="cb11-294"><a href="#cb11-294" aria-hidden="true" tabindex="-1"></a>    longitude<span class="op">=</span>alt.Longitude(<span class="st">'Longitude:Q'</span>, title<span class="op">=</span><span class="st">'Longitude'</span>),</span>
<span id="cb11-295"><a href="#cb11-295" aria-hidden="true" tabindex="-1"></a>    latitude<span class="op">=</span>alt.Latitude(<span class="st">'Latitude:Q'</span>, title<span class="op">=</span><span class="st">'Latitude'</span>),</span>
<span id="cb11-296"><a href="#cb11-296" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>alt.value(<span class="st">"orange"</span>),  </span>
<span id="cb11-297"><a href="#cb11-297" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">=</span>[<span class="st">'Latitude:Q'</span>, <span class="st">'Longitude:Q'</span>, <span class="st">'Year:O'</span>]</span>
<span id="cb11-298"><a href="#cb11-298" aria-hidden="true" tabindex="-1"></a>).add_selection(</span>
<span id="cb11-299"><a href="#cb11-299" aria-hidden="true" tabindex="-1"></a>    selector</span>
<span id="cb11-300"><a href="#cb11-300" aria-hidden="true" tabindex="-1"></a>).transform_filter(</span>
<span id="cb11-301"><a href="#cb11-301" aria-hidden="true" tabindex="-1"></a>    selector</span>
<span id="cb11-302"><a href="#cb11-302" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-303"><a href="#cb11-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-304"><a href="#cb11-304" aria-hidden="true" tabindex="-1"></a>final_map <span class="op">=</span> background_map <span class="op">+</span> theft_map</span>
<span id="cb11-305"><a href="#cb11-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-306"><a href="#cb11-306" aria-hidden="true" tabindex="-1"></a>final_map.properties(</span>
<span id="cb11-307"><a href="#cb11-307" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Theft Crime Locations in Chicago by Year"</span></span>
<span id="cb11-308"><a href="#cb11-308" aria-hidden="true" tabindex="-1"></a>).show()</span>
<span id="cb11-309"><a href="#cb11-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-310"><a href="#cb11-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-311"><a href="#cb11-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-312"><a href="#cb11-312" aria-hidden="true" tabindex="-1"></a>We created a script that reads a GeoJSON file containing Chicago's boundary data and converts it into a format compatible with Altair. By filtering the dataset for valid latitude and longitude values and focusing specifically on the "THEFT" crime type, we ensured that the analysis exclusively concentrates on larceny offenses, keeping the data relevant. To improve visualization clarity and performance, we applied stratified random sampling, limiting the dataset to a maximum of 2,000 points per year.</span>
<span id="cb11-313"><a href="#cb11-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-314"><a href="#cb11-314" aria-hidden="true" tabindex="-1"></a>We used alt.selection_single() to implement a dynamic year selector, allowing users to interactively choose specific years from a dropdown menu. To ensure geographic accuracy, we employed the Mercator projection to render the background map of Chicago, with black borders and a light gray fill. Theft crime locations are overlaid as semi-transparent orange circles, and tooltips display details such as latitude, longitude, and year when hovered over. Our interactive visualization, "Theft Crime Locations in Chicago by Year (With Map Background)," combines the boundary map and crime data to help users explore spatial and temporal patterns of theft. This tool offers valuable insights into theft hotspots and trends over time, supporting data-driven decision-making and resource allocation.</span>
<span id="cb11-315"><a href="#cb11-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-316"><a href="#cb11-316" aria-hidden="true" tabindex="-1"></a><span class="fu"># Shiny App</span></span>
<span id="cb11-317"><a href="#cb11-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-318"><a href="#cb11-318" aria-hidden="true" tabindex="-1"></a>import pandas as pd</span>
<span id="cb11-319"><a href="#cb11-319" aria-hidden="true" tabindex="-1"></a>from shiny import App, render, ui, reactive</span>
<span id="cb11-320"><a href="#cb11-320" aria-hidden="true" tabindex="-1"></a>import altair as alt</span>
<span id="cb11-321"><a href="#cb11-321" aria-hidden="true" tabindex="-1"></a>import nest_asyncio</span>
<span id="cb11-322"><a href="#cb11-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-323"><a href="#cb11-323" aria-hidden="true" tabindex="-1"></a>nest_asyncio.apply()</span>
<span id="cb11-324"><a href="#cb11-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-325"><a href="#cb11-325" aria-hidden="true" tabindex="-1"></a>analysis_data = pd.read_csv('/Users/suyuanfang/Desktop/Pyhton/final project/analysis_data.csv')</span>
<span id="cb11-326"><a href="#cb11-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-327"><a href="#cb11-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-328"><a href="#cb11-328" aria-hidden="true" tabindex="-1"></a>crime_types = analysis_data<span class="co">[</span><span class="ot">'Primary Type'</span><span class="co">]</span>.unique()</span>
<span id="cb11-329"><a href="#cb11-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-330"><a href="#cb11-330" aria-hidden="true" tabindex="-1"></a>app_ui = ui.page_fluid(</span>
<span id="cb11-331"><a href="#cb11-331" aria-hidden="true" tabindex="-1"></a>    ui.h1("Chicago Crime Data Visualization"),</span>
<span id="cb11-332"><a href="#cb11-332" aria-hidden="true" tabindex="-1"></a>    ui.input_selectize(</span>
<span id="cb11-333"><a href="#cb11-333" aria-hidden="true" tabindex="-1"></a>        "crime_types",</span>
<span id="cb11-334"><a href="#cb11-334" aria-hidden="true" tabindex="-1"></a>        "Select Crime Types:",</span>
<span id="cb11-335"><a href="#cb11-335" aria-hidden="true" tabindex="-1"></a>        choices=sorted(crime_types.tolist()),</span>
<span id="cb11-336"><a href="#cb11-336" aria-hidden="true" tabindex="-1"></a>        selected=crime_types.tolist()<span class="co">[</span><span class="ot">:5</span><span class="co">]</span>,</span>
<span id="cb11-337"><a href="#cb11-337" aria-hidden="true" tabindex="-1"></a>        multiple=True,</span>
<span id="cb11-338"><a href="#cb11-338" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-339"><a href="#cb11-339" aria-hidden="true" tabindex="-1"></a>    ui.output_ui("crime_plot")</span>
<span id="cb11-340"><a href="#cb11-340" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-341"><a href="#cb11-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-342"><a href="#cb11-342" aria-hidden="true" tabindex="-1"></a>def server(input, output, session):</span>
<span id="cb11-343"><a href="#cb11-343" aria-hidden="true" tabindex="-1"></a>    @reactive.Calc</span>
<span id="cb11-344"><a href="#cb11-344" aria-hidden="true" tabindex="-1"></a>    def filtered_data():</span>
<span id="cb11-345"><a href="#cb11-345" aria-hidden="true" tabindex="-1"></a>        selected_types = input.crime_types()</span>
<span id="cb11-346"><a href="#cb11-346" aria-hidden="true" tabindex="-1"></a>        if not selected_types:</span>
<span id="cb11-347"><a href="#cb11-347" aria-hidden="true" tabindex="-1"></a>            return pd.DataFrame(columns=<span class="co">[</span><span class="ot">'Primary Type'</span><span class="co">]</span>)</span>
<span id="cb11-348"><a href="#cb11-348" aria-hidden="true" tabindex="-1"></a>        return analysis_data<span class="co">[</span><span class="ot">analysis_data['Primary Type'].isin(selected_types)</span><span class="co">]</span></span>
<span id="cb11-349"><a href="#cb11-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-350"><a href="#cb11-350" aria-hidden="true" tabindex="-1"></a><span class="in">    @output</span></span>
<span id="cb11-351"><a href="#cb11-351" aria-hidden="true" tabindex="-1"></a><span class="in">    @render.ui</span></span>
<span id="cb11-352"><a href="#cb11-352" aria-hidden="true" tabindex="-1"></a><span class="in">    def crime_plot():</span></span>
<span id="cb11-353"><a href="#cb11-353" aria-hidden="true" tabindex="-1"></a><span class="in">        data = filtered_data()</span></span>
<span id="cb11-354"><a href="#cb11-354" aria-hidden="true" tabindex="-1"></a><span class="in">        if data.empty:</span></span>
<span id="cb11-355"><a href="#cb11-355" aria-hidden="true" tabindex="-1"></a><span class="in">            empty_chart = alt.Chart(pd.DataFrame({'x': [], 'y': []})).mark_bar()</span></span>
<span id="cb11-356"><a href="#cb11-356" aria-hidden="true" tabindex="-1"></a><span class="in">            return ui.HTML(empty_chart.to_html())</span></span>
<span id="cb11-357"><a href="#cb11-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-358"><a href="#cb11-358" aria-hidden="true" tabindex="-1"></a><span class="in">        crime_counts = data['Primary Type'].value_counts().reset_index()</span></span>
<span id="cb11-359"><a href="#cb11-359" aria-hidden="true" tabindex="-1"></a><span class="in">        crime_counts.columns = ['Crime_Type', 'Count']</span></span>
<span id="cb11-360"><a href="#cb11-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-361"><a href="#cb11-361" aria-hidden="true" tabindex="-1"></a><span class="in">        chart = (</span></span>
<span id="cb11-362"><a href="#cb11-362" aria-hidden="true" tabindex="-1"></a><span class="in">            alt.Chart(crime_counts)</span></span>
<span id="cb11-363"><a href="#cb11-363" aria-hidden="true" tabindex="-1"></a><span class="in">            .mark_bar()</span></span>
<span id="cb11-364"><a href="#cb11-364" aria-hidden="true" tabindex="-1"></a><span class="in">            .encode(</span></span>
<span id="cb11-365"><a href="#cb11-365" aria-hidden="true" tabindex="-1"></a><span class="in">                x=alt.X('Crime_Type:N', sort='-y', title='Crime Type'),</span></span>
<span id="cb11-366"><a href="#cb11-366" aria-hidden="true" tabindex="-1"></a><span class="in">                y=alt.Y('Count:Q', title='Number of Crimes'),</span></span>
<span id="cb11-367"><a href="#cb11-367" aria-hidden="true" tabindex="-1"></a><span class="in">                color=alt.Color('Count:Q', scale=alt.Scale(scheme='blues')),</span></span>
<span id="cb11-368"><a href="#cb11-368" aria-hidden="true" tabindex="-1"></a><span class="in">                tooltip=['Crime_Type', 'Count'],</span></span>
<span id="cb11-369"><a href="#cb11-369" aria-hidden="true" tabindex="-1"></a><span class="in">            )</span></span>
<span id="cb11-370"><a href="#cb11-370" aria-hidden="true" tabindex="-1"></a><span class="in">            .properties(</span></span>
<span id="cb11-371"><a href="#cb11-371" aria-hidden="true" tabindex="-1"></a><span class="in">                title='Number of Crimes for Selected Crime Types',</span></span>
<span id="cb11-372"><a href="#cb11-372" aria-hidden="true" tabindex="-1"></a><span class="in">                width='container',</span></span>
<span id="cb11-373"><a href="#cb11-373" aria-hidden="true" tabindex="-1"></a><span class="in">                height=400,</span></span>
<span id="cb11-374"><a href="#cb11-374" aria-hidden="true" tabindex="-1"></a><span class="in">            )</span></span>
<span id="cb11-375"><a href="#cb11-375" aria-hidden="true" tabindex="-1"></a><span class="in">            .configure_axis(labelAngle=-45)</span></span>
<span id="cb11-376"><a href="#cb11-376" aria-hidden="true" tabindex="-1"></a><span class="in">        )</span></span>
<span id="cb11-377"><a href="#cb11-377" aria-hidden="true" tabindex="-1"></a><span class="in">        return ui.HTML(chart.to_html())</span></span>
<span id="cb11-378"><a href="#cb11-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-379"><a href="#cb11-379" aria-hidden="true" tabindex="-1"></a>app = App(app_ui, server)</span>
<span id="cb11-380"><a href="#cb11-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-381"><a href="#cb11-381" aria-hidden="true" tabindex="-1"></a>if __name__ == "__main__":</span>
<span id="cb11-382"><a href="#cb11-382" aria-hidden="true" tabindex="-1"></a>    app.run()</span>
<span id="cb11-383"><a href="#cb11-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-384"><a href="#cb11-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-385"><a href="#cb11-385" aria-hidden="true" tabindex="-1"></a>This Shiny app allows users to explore Chicago crime data interactively. It loads crime data from a CSV file and provides a dropdown menu where users can select one or more crime types to analyze. Based on the selected types, the app filters the data and dynamically generates a bar chart using Altair. The chart displays the number of crimes for each selected type, with color intensity representing the counts and tooltips showing details when hovering over the bars. The app ensures a smooth user experience by dynamically updating the chart in response to user input and handling cases where no data is selected.</span>
<span id="cb11-386"><a href="#cb11-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-387"><a href="#cb11-387" aria-hidden="true" tabindex="-1"></a><span class="fu"># recommendations and conclusion</span></span>
<span id="cb11-388"><a href="#cb11-388" aria-hidden="true" tabindex="-1"></a>In order to address these obstacles, it is imperative to implement a multifaceted strategy that combines immediate interventions with long-term structural reforms. It is advised that seasonal crime prevention programs be implemented to address specific crime categories during their peak periods. For example, the implementation of targeted measures during the winter can address property crimes, while the deployment of additional law enforcement resources and community outreach programs during the summer can help mitigate the increase in larceny.</span>
<span id="cb11-389"><a href="#cb11-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-390"><a href="#cb11-390" aria-hidden="true" tabindex="-1"></a>In order to address the root causes of illicit activity, it is essential to expand welfare programs. Investing in education, mental health services, and affordable housing can significantly reduce crime rates by addressing the underlying social inequalities. These initiatives should prioritize communities that have been identified as high-crime areas through the analysis.</span>
<span id="cb11-391"><a href="#cb11-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-392"><a href="#cb11-392" aria-hidden="true" tabindex="-1"></a>Urban planning has a substantial impact on crime prevention. By enhancing the visibility and illumination of public spaces, particularly in high-crime areas, it is possible to deter criminal activities. The establishment of secure neighborhoods is facilitated by the promotion of mixed-use developments that integrate residential, commercial, and recreational spaces, thereby fostering informal surveillance and community engagement.</span>
<span id="cb11-393"><a href="#cb11-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-394"><a href="#cb11-394" aria-hidden="true" tabindex="-1"></a>Finally, the reduction of crime requires the expansion of employment opportunities. Residents can acquire the requisite skills for sustainable employment through vocational training programs, while job opportunities can be generated in vulnerable communities through partnerships with local businesses. In addition to improving economic prospects, these initiatives enhance a sense of community stability and resilience.</span>
<span id="cb11-395"><a href="#cb11-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-396"><a href="#cb11-396" aria-hidden="true" tabindex="-1"></a>The findings of this report emphasize the importance of data-driven policymaking in Chicago's crime prevention initiatives. By integrating seasonal prevention strategies, welfare support, urban redevelopment, and employment growth, policymakers can develop comprehensive solutions that promote safety and equity. The holistic approach of addressing crime through socioeconomic empowerment and sustainable development is consistent with the progressive vision, which will enable a more prosperous and secure Chicago.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>